==========================================
K-Means E4: D-tiling (Dimension Blocking) Optimization
==========================================
Job ID: 270730
Node: a100-a
Partition: 
Time limit: 
Experiment: e4
Build definitions: -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8
Optimizations:
  - TRANSPOSED_C: Transposed centroids (from E1)
  - HOIST: Invariant hoisting (from E2)
  - BRANCHLESS: Branchless argmin (from E2)
  - STRIDE_PTR: Strided pointer arithmetic (from E2)
  - TILE_D: D-tiling (dimension blocking) cache optimization
==========================================
System Information:
Linux a100-a 4.18.0-513.9.1.el8_9.x86_64 #1 SMP Sat Dec 2 05:23:44 EST 2023 x86_64 x86_64 x86_64 GNU/Linux

Compiler Information:
gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-20)
Copyright (C) 2018 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.


Building project with E4 D-tiling optimization...
rm -rf build
mkdir -p build
g++ -std=c++17 -O2 -Wall -Wextra -Wshadow -Wconversion -Iinclude -fno-tree-vectorize -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8 -c src/main.cpp -o build/main.o
g++ -std=c++17 -O2 -Wall -Wextra -Wshadow -Wconversion -Iinclude -fno-tree-vectorize -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8 -c src/kmeans.cpp -o build/kmeans.o
g++ build/main.o build/kmeans.o  -lstdc++fs -o build/kmeans
Build completed successfully!

Running E4 D-tiling experiment...
Optimizations:
  - D-tiling: Process dimensions in tiles of 8 for better cache locality
  - Cache blocking: Dimension tiles improve spatial locality
  - Combined with E1+E2: Transposed centroids + micro-optimizations

This will generate:
  - Timing data (3 warm-up + 5 measurement runs)
  - Convergence analysis
  - System information capture
  - Profiling data (if available)

=== COSC3500 M1 K-Means Experiment E4 ===
Running experiments and profiling on Linux...
Available profiling tools: gprof, perf, valgrind/cachegrind

[0;34m[INFO][0m Building project for TIMINGS...
rm -rf build
[0;34m[INFO][0m Building with definitions: -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8
mkdir -p build
g++ -std=c++17 -O2 -Wall -Wextra -Wshadow -Wconversion -Iinclude -fno-tree-vectorize -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8 -c src/main.cpp -o build/main.o
g++ -std=c++17 -O2 -Wall -Wextra -Wshadow -Wconversion -Iinclude -fno-tree-vectorize -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8 -c src/kmeans.cpp -o build/kmeans.o
g++ build/main.o build/kmeans.o  -lstdc++fs -o build/kmeans
[0;32m[SUCCESS][0m Build complete
[0;34m[INFO][0m Creating benchmark directory structure...
[0;34m[INFO][0m Capturing system information...
=== System info ===
Sun Sep  7 13:51:01 AEST 2025
Compiler: g++ (GCC) 8.5.0 20210514 (Red Hat 8.5.0-20)
Makefile CXXFLAGS_BASE: -std=c++17 -O2 -Wall -Wextra -Wshadow -Wconversion -Iinclude
Makefile ANTIVEC_FLAGS: 
Environment CXX: g++
Environment CXXFLAGS: not set
Environment ANTIVEC: 1
Environment DEFS: not set
Git SHA: 84838d7
Git branch: main
Git status: 1 files modified
System: Linux a100-a 4.18.0-513.9.1.el8_9.x86_64 #1 SMP Sat Dec 2 05:23:44 EST 2023 x86_64 x86_64 x86_64 GNU/Linux
Architecture:        x86_64
CPU op-mode(s):      32-bit, 64-bit
Byte Order:          Little Endian
CPU(s):              8
On-line CPU(s) list: 0-7
Thread(s) per core:  1
Core(s) per socket:  8
Socket(s):           1
NUMA node(s):        1
Vendor ID:           AuthenticAMD
CPU family:          23
Model:               0
Model name:          AMD EPYC 7542 32-Core Processor
Stepping:            0
CPU MHz:             2894.561
BogoMIPS:            5789.12
Hypervisor vendor:   VMware
Virtualization type: full
L1d cache:           32K
L1i cache:           32K
              total        used        free      shared  buff/cache   available
Mem:           62Gi       1.9Gi       5.1Gi       1.4Gi        55Gi        58Gi
Swap:         5.0Gi        19Mi       5.0Gi
[0;34m[INFO][0m Capturing Slurm node information...
[0;32m[SUCCESS][0m Slurm node info captured
[0;32m[SUCCESS][0m System info captured
[0;34m[INFO][0m Running canonical config: N=200000, D=16, K=8, iters=10, seed=1
[0;34m[INFO][0m Running 3 warm-up + 5 measurement runs for statistical significance...
[0;34m[INFO][0m Warm-up run 1/3
[0;34m[INFO][0m Warm-up run 2/3
[0;34m[INFO][0m Warm-up run 3/3
[0;34m[INFO][0m Measurement run 1/5
Final inertia: 7984073.996076
Time split: assign=89.959537%, update=10.040463%
[0;34m[INFO][0m Measurement run 2/5
Final inertia: 7984073.996076
Time split: assign=90.225835%, update=9.774165%
[0;34m[INFO][0m Measurement run 3/5
Final inertia: 7984073.996076
Time split: assign=90.222189%, update=9.777811%
[0;34m[INFO][0m Measurement run 4/5
Final inertia: 7984073.996076
Time split: assign=90.136852%, update=9.863148%
[0;34m[INFO][0m Measurement run 5/5
Final inertia: 7984073.996076
Time split: assign=90.177257%, update=9.822743%
[0;32m[SUCCESS][0m Canonical config complete (5 measurement runs)
[0;34m[INFO][0m Running stress config: N=100000, D=64, K=64, iters=10, seed=1
[0;34m[INFO][0m Running 3 warm-up + 5 measurement runs for statistical significance...
[0;34m[INFO][0m Warm-up run 1/3
[0;34m[INFO][0m Warm-up run 2/3
[0;34m[INFO][0m Warm-up run 3/3
[0;34m[INFO][0m Measurement run 1/5
Warning: centroid 14 has no assigned points
Final inertia: 16505107.138741
Time split: assign=98.567854%, update=1.432146%
[0;34m[INFO][0m Measurement run 2/5
Warning: centroid 14 has no assigned points
Final inertia: 16505107.138741
Time split: assign=98.563061%, update=1.436939%
[0;34m[INFO][0m Measurement run 3/5
Warning: centroid 14 has no assigned points
Final inertia: 16505107.138741
Time split: assign=98.588545%, update=1.411455%
[0;34m[INFO][0m Measurement run 4/5
Warning: centroid 14 has no assigned points
Final inertia: 16505107.138741
Time split: assign=98.563048%, update=1.436952%
[0;34m[INFO][0m Measurement run 5/5
Warning: centroid 14 has no assigned points
Final inertia: 16505107.138741
Time split: assign=98.564418%, update=1.435582%
[0;32m[SUCCESS][0m Stress config complete (5 measurement runs)
[0;34m[INFO][0m Running profiling on stress config...
[0;34m[INFO][0m Using gprof for function-level profiling...
rm -rf build
mkdir -p build
g++ -std=c++17 -O2 -Wall -Wextra -Wshadow -Wconversion -Iinclude -fno-tree-vectorize -pg -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8 -c src/main.cpp -o build/main.o
g++ -std=c++17 -O2 -Wall -Wextra -Wshadow -Wconversion -Iinclude -fno-tree-vectorize -pg -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8 -c src/kmeans.cpp -o build/kmeans.o
g++ build/main.o build/kmeans.o -pg -lstdc++fs -o build/kmeans
[0;32m[SUCCESS][0m gprof profile saved to bench/e4/gprof_e4.txt
[0;34m[INFO][0m Using perf for hardware cache analysis...
rm -rf build
mkdir -p build
g++ -std=c++17 -O2 -Wall -Wextra -Wshadow -Wconversion -Iinclude -fno-tree-vectorize -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8 -c src/main.cpp -o build/main.o
g++ -std=c++17 -O2 -Wall -Wextra -Wshadow -Wconversion -Iinclude -fno-tree-vectorize -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8 -c src/kmeans.cpp -o build/kmeans.o
g++ build/main.o build/kmeans.o  -lstdc++fs -o build/kmeans
[0;34m[INFO][0m Checking available perf events...
[0;32m[SUCCESS][0m L1 cache events available
[1;33m[WARNING][0m L2 cache events not available, using L1 only
[0;34m[INFO][0m Recording hardware performance with perf (events: L1-dcache-load-misses,L1-dcache-loads)...
[1;33m[WARNING][0m perf record failed or timed out - likely permission or event availability issue
[1;33m[WARNING][0m Note: perf may require special permissions or the cache events may not be available on this system
[1;33m[WARNING][0m Continuing without perf cache analysis...
[0;34m[INFO][0m Capturing system information (Linux)...
[0;32m[SUCCESS][0m System info saved to bench/e4/system_info.txt
rm -rf build
mkdir -p build
g++ -std=c++17 -O2 -Wall -Wextra -Wshadow -Wconversion -Iinclude -fno-tree-vectorize -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8 -c src/main.cpp -o build/main.o
g++ -std=c++17 -O2 -Wall -Wextra -Wshadow -Wconversion -Iinclude -fno-tree-vectorize -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8 -c src/kmeans.cpp -o build/kmeans.o
g++ build/main.o build/kmeans.o  -lstdc++fs -o build/kmeans

=== Experiment E4 Complete ===
Results saved in bench/e4/

Files generated:
total 570
drwx------ 2 s4698382 uusers    57 Sep  7 13:51 .
drwx------ 7 s4698382 uusers     7 Sep  7 13:51 ..
-rw------- 1 s4698382 uusers 27081 Sep  7 13:51 gprof_e4.txt
-rw------- 1 s4698382 uusers   349 Sep  7 13:51 inertia_N100000_D64_K64_iters10_seed1_run1.csv
-rw------- 1 s4698382 uusers   349 Sep  7 13:51 inertia_N100000_D64_K64_iters10_seed1_run2.csv
-rw------- 1 s4698382 uusers   349 Sep  7 13:51 inertia_N100000_D64_K64_iters10_seed1_run3.csv
-rw------- 1 s4698382 uusers   349 Sep  7 13:51 inertia_N100000_D64_K64_iters10_seed1_run4.csv
-rw------- 1 s4698382 uusers   349 Sep  7 13:51 inertia_N100000_D64_K64_iters10_seed1_run5.csv
-rw------- 1 s4698382 uusers   349 Sep  7 13:51 inertia_N100000_D64_K64_iters10_seed1_run6.csv
-rw------- 1 s4698382 uusers   349 Sep  7 13:51 inertia_N100000_D64_K64_iters10_seed1_run7.csv
-rw------- 1 s4698382 uusers   349 Sep  7 13:51 inertia_N100000_D64_K64_iters10_seed1_run8.csv
-rw------- 1 s4698382 uusers   184 Sep  7 13:51 inertia_N100000_D64_K64_iters5_seed1.csv
-rw------- 1 s4698382 uusers   339 Sep  7 13:51 inertia_N200000_D16_K8_iters10_seed1_run1.csv
-rw------- 1 s4698382 uusers   339 Sep  7 13:51 inertia_N200000_D16_K8_iters10_seed1_run2.csv
-rw------- 1 s4698382 uusers   339 Sep  7 13:51 inertia_N200000_D16_K8_iters10_seed1_run3.csv
-rw------- 1 s4698382 uusers   339 Sep  7 13:51 inertia_N200000_D16_K8_iters10_seed1_run4.csv
-rw------- 1 s4698382 uusers   339 Sep  7 13:51 inertia_N200000_D16_K8_iters10_seed1_run5.csv
-rw------- 1 s4698382 uusers   339 Sep  7 13:51 inertia_N200000_D16_K8_iters10_seed1_run6.csv
-rw------- 1 s4698382 uusers   339 Sep  7 13:51 inertia_N200000_D16_K8_iters10_seed1_run7.csv
-rw------- 1 s4698382 uusers   339 Sep  7 13:51 inertia_N200000_D16_K8_iters10_seed1_run8.csv
-rw------- 1 s4698382 uusers   218 Sep  7 13:51 meta_N100000_D64_K64_iters10_seed1_run1.txt
-rw------- 1 s4698382 uusers   218 Sep  7 13:51 meta_N100000_D64_K64_iters10_seed1_run2.txt
-rw------- 1 s4698382 uusers   218 Sep  7 13:51 meta_N100000_D64_K64_iters10_seed1_run3.txt
-rw------- 1 s4698382 uusers   218 Sep  7 13:51 meta_N100000_D64_K64_iters10_seed1_run4.txt
-rw------- 1 s4698382 uusers   218 Sep  7 13:51 meta_N100000_D64_K64_iters10_seed1_run5.txt
-rw------- 1 s4698382 uusers   218 Sep  7 13:51 meta_N100000_D64_K64_iters10_seed1_run6.txt
-rw------- 1 s4698382 uusers   218 Sep  7 13:51 meta_N100000_D64_K64_iters10_seed1_run7.txt
-rw------- 1 s4698382 uusers   218 Sep  7 13:51 meta_N100000_D64_K64_iters10_seed1_run8.txt
-rw------- 1 s4698382 uusers   217 Sep  7 13:51 meta_N100000_D64_K64_iters5_seed1.txt
-rw------- 1 s4698382 uusers   217 Sep  7 13:51 meta_N200000_D16_K8_iters10_seed1_run1.txt
-rw------- 1 s4698382 uusers   217 Sep  7 13:51 meta_N200000_D16_K8_iters10_seed1_run2.txt
-rw------- 1 s4698382 uusers   217 Sep  7 13:51 meta_N200000_D16_K8_iters10_seed1_run3.txt
-rw------- 1 s4698382 uusers   217 Sep  7 13:51 meta_N200000_D16_K8_iters10_seed1_run4.txt
-rw------- 1 s4698382 uusers   217 Sep  7 13:51 meta_N200000_D16_K8_iters10_seed1_run5.txt
-rw------- 1 s4698382 uusers   217 Sep  7 13:51 meta_N200000_D16_K8_iters10_seed1_run6.txt
-rw------- 1 s4698382 uusers   217 Sep  7 13:51 meta_N200000_D16_K8_iters10_seed1_run7.txt
-rw------- 1 s4698382 uusers   217 Sep  7 13:51 meta_N200000_D16_K8_iters10_seed1_run8.txt
-rw------- 1 s4698382 uusers   632 Sep  7 13:51 perf_cache.data
-rw------- 1 s4698382 uusers  1400 Sep  7 13:51 sysinfo_e4.txt
-rw------- 1 s4698382 uusers  1200 Sep  7 13:51 system_info.txt
-rw------- 1 s4698382 uusers   290 Sep  7 13:51 times_N100000_D64_K64_iters10_seed1_run1.csv
-rw------- 1 s4698382 uusers   287 Sep  7 13:51 times_N100000_D64_K64_iters10_seed1_run2.csv
-rw------- 1 s4698382 uusers   289 Sep  7 13:51 times_N100000_D64_K64_iters10_seed1_run3.csv
-rw------- 1 s4698382 uusers   291 Sep  7 13:51 times_N100000_D64_K64_iters10_seed1_run4.csv
-rw------- 1 s4698382 uusers   291 Sep  7 13:51 times_N100000_D64_K64_iters10_seed1_run5.csv
-rw------- 1 s4698382 uusers   290 Sep  7 13:51 times_N100000_D64_K64_iters10_seed1_run6.csv
-rw------- 1 s4698382 uusers   291 Sep  7 13:51 times_N100000_D64_K64_iters10_seed1_run7.csv
-rw------- 1 s4698382 uusers   290 Sep  7 13:51 times_N100000_D64_K64_iters10_seed1_run8.csv
-rw------- 1 s4698382 uusers   162 Sep  7 13:51 times_N100000_D64_K64_iters5_seed1.csv
-rw------- 1 s4698382 uusers   290 Sep  7 13:51 times_N200000_D16_K8_iters10_seed1_run1.csv
-rw------- 1 s4698382 uusers   286 Sep  7 13:51 times_N200000_D16_K8_iters10_seed1_run2.csv
-rw------- 1 s4698382 uusers   294 Sep  7 13:51 times_N200000_D16_K8_iters10_seed1_run3.csv
-rw------- 1 s4698382 uusers   292 Sep  7 13:51 times_N200000_D16_K8_iters10_seed1_run4.csv
-rw------- 1 s4698382 uusers   292 Sep  7 13:51 times_N200000_D16_K8_iters10_seed1_run5.csv
-rw------- 1 s4698382 uusers   294 Sep  7 13:51 times_N200000_D16_K8_iters10_seed1_run6.csv
-rw------- 1 s4698382 uusers   290 Sep  7 13:51 times_N200000_D16_K8_iters10_seed1_run7.csv
-rw------- 1 s4698382 uusers   294 Sep  7 13:51 times_N200000_D16_K8_iters10_seed1_run8.csv

Key improvements in this run:
  ✓ 3 warm-up + 5 measurement runs for statistical significance
  ✓ Normalized cache statistics (misses per operation)
  ✓ Slurm node pinning information captured
  ✓ Build definitions: -DTRANSPOSED_C=1 -DHOIST=1 -DBRANCHLESS=1 -DSTRIDE_PTR=1 -DTILE_D=8

Next steps:
1. Review optimization results in bench/e4/
2. Compare with E0 baseline results
3. Analyze performance improvements
4. Proceed to next optimization (E5)

==========================================
E4 Experiment completed successfully!
==========================================
Generated files in bench/e4/:
58
files generated

File structure:
bench/e4/times_N100000_D64_K64_iters10_seed1_run2.csv
bench/e4/times_N100000_D64_K64_iters10_seed1_run5.csv
bench/e4/meta_N100000_D64_K64_iters10_seed1_run8.txt
bench/e4/meta_N100000_D64_K64_iters10_seed1_run6.txt
bench/e4/meta_N100000_D64_K64_iters10_seed1_run1.txt
bench/e4/times_N200000_D16_K8_iters10_seed1_run7.csv
bench/e4/meta_N200000_D16_K8_iters10_seed1_run5.txt
bench/e4/meta_N200000_D16_K8_iters10_seed1_run2.txt
bench/e4/inertia_N200000_D16_K8_iters10_seed1_run8.csv
bench/e4/inertia_N100000_D64_K64_iters10_seed1_run4.csv
bench/e4/inertia_N200000_D16_K8_iters10_seed1_run6.csv
bench/e4/inertia_N100000_D64_K64_iters5_seed1.csv
bench/e4/inertia_N200000_D16_K8_iters10_seed1_run1.csv
bench/e4/inertia_N100000_D64_K64_iters10_seed1_run3.csv
bench/e4/gprof_e4.txt
bench/e4/times_N200000_D16_K8_iters10_seed1_run6.csv
bench/e4/times_N200000_D16_K8_iters10_seed1_run1.csv
bench/e4/times_N200000_D16_K8_iters10_seed1_run8.csv
bench/e4/times_N100000_D64_K64_iters5_seed1.csv
bench/e4/meta_N100000_D64_K64_iters10_seed1_run7.txt

Key output files:
✅ System information captured
✅ Canonical config timing data
✅ Stress config timing data

E4 experiment results are ready for analysis!
Next steps:
  1. Generate plots: python scripts/analyze_experiment.py 4
  2. Review summary: cat bench/e4/summary_e4.md
  3. Check plots: ls -la plots/
  4. Compare with E0/E1/E2: python scripts/analyze_experiment.py 0 1 2 4

Job completed at: Sun Sep  7 13:51:38 AEST 2025
